<!doctype html><html lang=ja>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>jQuery1.9の変更内容まとめ - EagleLand</title>
<link rel=icon href=/favicon.png>
<link rel="shortcut icon" href=/favicon.png>
<link rel="shortcut icon" href=/favicon.svg type=image/svg+xml sizes=any>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.2/build/styles/dracula.min.css>
<link rel=stylesheet href=/css/settings.css>
<link rel=stylesheet href=/css/tools.css>
<link rel=stylesheet href=/css/generic.css>
<link rel=stylesheet href=/css/base.css>
<link rel=stylesheet href=/css/objects.css>
<link rel=stylesheet href=/css/components.css>
<link rel=stylesheet href=/css/trumps.css>
<link rel=alternate href=/rss.xml title=1000ch.net type=application/rss+xml>
<meta name=author content="Shogo Sensui">
<meta name=copyright content="Copyright (c) Shogo Sensui; Licensed under Creative Commons Attribution-Noncommercial-Share Japan">
<meta property="og:description" content="jQuery1.9の変更内容まとめ 先日jQuery1.9beta1が公開されたが、ロードマップは変わらないだろうし、変更点をまとめる。
前々から非推奨アナウンスがあったものを削除するなど主に内部APIの整理で、ファイルサイズの削減とパフォーマンスが向上される予定。2.0は古いIE等のサポートを止め、再設計・軽量化なので1.9とAPIは変わらないそう。
最近のjQueryはフルコメントで10000行くらいあったが、2.0でどのくらいになるのか。超軽くなったりしないかな。恐らくないな。
 jQuery Blog > jQuery 1.9 Beta 1 Released jQuery Core 1.9 Upgrade Guide  ↑のUpgrade Guideを読み流してみる。
.add() 内部処理の仕方を変更。
.addBack(selector)が.addSelf()に 一応エイリアスとして残るみたい。
.after()と.before()と.replaceWith() 親を持たないノードの変更はバグを生む可能性があるので、内包する対象ノードが 親を持たない場合はこれらを使っても何もしない 。
.appendTo()と.insertBefore()と.insertAfter()と.replaceAll() 要素の追加や削除系の関数ですが、1.9以降は.end()をしなくても、要素が追加や削除された状態のjQueryオブジェクトを返す そう。
checkboxのクリック時イベントのハンドラ中の状態 未チェックのチェックボックスをクリックするとクリックイベントが発火されるけど、クリックイベント中でのチェックボックスの状態が、v1.8以前は未チェックだったことに対しv1.9からはチェックされた状態でコールバックされるようになった。
ユーザーアクションと反対の状態で取得出来る っぽい。我ながらわかり難い日本語。
focusイベント ネイティブのfocusイベントは、DOMがフォーカスされてから初めてイベントが発火されるけどv1.9は、DOMがフォーカスされなくてもfocusイベントの実施を最後まで行う。focus()あるいはtrigger(&#34;focus&#34;)で、内包する要素に対しfocusを発火するが、focusイベントがハンドルされない要素があっても、全ての要素に発火をする、ということになりる。
$(htmlString)と$(selectorString) 引数にhtmlタグが含まれていたらhtmlStringとして扱う。 タグ形式であってもhtmlタグではない場合は認識されず、$.parseHTML()を通すことで初めてDOMノードが生成される。
プラグインは用意されるっぽいが、有効なCSSセレクタでも今までのようには動かないようで、移行の際は注意。なるべく#idと.classNameで走査しろということなんだろうか。
.data()メソッドからイベントは発火されない set/getで監視しないようになった。また、.data(&#34;abc.def&#34;)はabc.defの値のみ取得し、abcからは取得しないとのこと。
jQueryの独立したノードの順序 うーん、これはいいか。
要素中にscriptがある場合実行するようになった HTML文字列を扱うメソッド（.append()とか.wrap()とか）にscriptがある場合は 1.9以降はscriptを実行する ようになり、再実行されるのを防ぐため、そのscriptのノードは除かれるらしい。ほほう。
scriptは同期的に評価されるため実行に時間がかかり、また、scriptの挙動に対してアクセスするインターフェースは用意しませんとのこと。 「scriptの実行のためにこの挙動を利用するな！」 、新しいscriptをロードするときにはjQuery.getScript()を使ってくれとのこと。
.attr()と.prop() .prop()はプロパティの値の取得と設定のために1.6から用意されて、.attr()は値の設定には使わないようにされてきた。1.9においては特別なケースの.attr()の使用をサポートするそう。例えばチェックボックスの値の設定時の挙動。
古代IEにおける$(&#34;input&#34;).attr(&#34;type&#34;, newValue) 1.9においてもIE6/7/8だと例外が発生するものの、許容するブラウザのために残し、使える場合はどうぞ使ってくださいとのこと。個人的にはこんなイレギュラーなことしないけど。
擬似イベントhover mouseenter + mouseleaveと同義なのでサポートしない。
jQueryオブジェクトの.selectorプロパティ 元々非推奨のプロパティだが、v1.9からはメソッドチェーンの場合などにこのプロパティの整合性を保つことをしない。まぁ、これもあまり使わない。
jQuery.attr() 明示されていなかったjQuery.attr(elem, name, value, pass)をサポートしなくなる。よって、今後はpassを引数として使うことが出来ない。
jQuery.ajax()のJSON結果が空文字の場合 jQuery.">
<meta property="og:image" content="https://1000ch.net/img/apple-touch-icon.png">
<meta name=twitter:card content="summary">
<meta property="og:type" content="article">
<meta property="og:url" content="https://1000ch.net/posts/2012/jquery-1-9.html">
<meta property="og:site_name" content="EagleLand">
<meta property="og:title" content="jQuery1.9の変更内容まとめ">
<meta name=twitter:site content="@1000ch">
<meta name=twitter:url content="https://1000ch.net/posts/2012/jquery-1-9.html">
<meta name=twitter:title content="jQuery1.9の変更内容まとめ">
<meta name=google-site-verification content="BWewniqiBzRmrhpj51eLwug-F4hamFfyznl-ARb-Y4Y">
<link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon.png>
<link rel=apple-touch-icon-precomposed sizes=114x114 href=/img/apple-touch-icon.png>
<link rel=apple-touch-icon-precomposed sizes=72x72 href=/img/apple-touch-icon.png>
<link rel=apple-touch-icon-precomposed href=/img/apple-touch-icon.png>
<script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'),ga('create','UA-49530352-1','1000ch.net'),ga('send','pageview')</script>
</head>
<body>
<div class=Container>
<header class=Header>
<h1 class=Header__Title>
<a href=/>EagleLand</a>
</h1>
<nav class=Header__Menu>
<div class=Header__MenuItem>
<a href=/rss.xml>📻 RSS</a>
</div>
<div class=Header__MenuItem>
<a href="https://www.google.co.jp/search?q=site%3A1000ch.net">🔍 検索</a>
</div>
<div class=Header__MenuItem>
<a href=https://shogosensui.com>🌎 Who is 1000ch</a>
</div>
</nav>
</header>
<main class=Main>
<div class=PostHeader>
<span class="Label Label--gray pull-left">2012.12.19</span>
<label>
<input type=checkbox switch id=auto-phrase> 日本語のフレーズ改行
</label>
<label>
<input type=checkbox switch id=dark-mode> ダークモード
</label>
</div>
<h1 id=jquery19の変更内容まとめ>jQuery1.9の変更内容まとめ</h1>
<p>先日jQuery1.9beta1が公開されたが、ロードマップは変わらないだろうし、変更点をまとめる。</p>
<p>前々から非推奨アナウンスがあったものを削除するなど主に内部APIの整理で、ファイルサイズの削減とパフォーマンスが向上される予定。2.0は古いIE等のサポートを止め、再設計・軽量化なので1.9とAPIは変わらないそう。</p>
<p>最近のjQueryはフルコメントで10000行くらいあったが、2.0でどのくらいになるのか。超軽くなったりしないかな。恐らくないな。</p>
<ul>
<li><a href=http://blog.jquery.com/2012/12/17/jquery-1-9-beta-1-released/>jQuery Blog > jQuery 1.9 Beta 1 Released</a></li>
<li><a href=http://jquery.com/upgrade-guide/1.9/>jQuery Core 1.9 Upgrade Guide</a></li>
</ul>
<p>↑のUpgrade Guideを読み流してみる。</p>
<h2 id=add><code>.add()</code></h2>
<p>内部処理の仕方を変更。</p>
<h2 id=addbackselectorがaddselfに><code>.addBack(selector)</code>が<code>.addSelf()</code>に</h2>
<p>一応エイリアスとして残るみたい。</p>
<h2 id=afterとbeforeとreplacewith><code>.after()</code>と<code>.before()</code>と<code>.replaceWith()</code></h2>
<p>親を持たないノードの変更はバグを生む可能性があるので、内包する対象ノードが <strong>親を持たない場合はこれらを使っても何もしない</strong> 。</p>
<h2 id=appendtoとinsertbeforeとinsertafterとreplaceall><code>.appendTo()</code>と<code>.insertBefore()</code>と<code>.insertAfter()</code>と<code>.replaceAll()</code></h2>
<p>要素の追加や削除系の関数ですが、1.9以降は<code>.end()</code>をしなくても、<strong>要素が追加や削除された状態のjQueryオブジェクトを返す</strong> そう。</p>
<h2 id=checkboxのクリック時イベントのハンドラ中の状態>checkboxのクリック時イベントのハンドラ中の状態</h2>
<p>未チェックのチェックボックスをクリックするとクリックイベントが発火されるけど、クリックイベント中でのチェックボックスの状態が、v1.8以前は未チェックだったことに対しv1.9からはチェックされた状態でコールバックされるようになった。</p>
<p><strong>ユーザーアクションと反対の状態で取得出来る</strong> っぽい。我ながらわかり難い日本語。</p>
<h2 id=focusイベント>focusイベント</h2>
<p>ネイティブのfocusイベントは、DOMがフォーカスされてから初めてイベントが発火されるけどv1.9は、DOMがフォーカスされなくてもfocusイベントの実施を最後まで行う。<code>focus()</code>あるいは<code>trigger("focus")</code>で、内包する要素に対しfocusを発火するが、focusイベントがハンドルされない要素があっても、全ての要素に発火をする、ということになりる。</p>
<h2 id=htmlstringとselectorstring><code>$(htmlString)</code>と<code>$(selectorString)</code></h2>
<p><strong>引数にhtmlタグが含まれていたらhtmlStringとして扱う。</strong> タグ形式であってもhtmlタグではない場合は認識されず、<code>$.parseHTML()</code>を通すことで初めてDOMノードが生成される。</p>
<p>プラグインは用意されるっぽいが、有効なCSSセレクタでも今までのようには動かないようで、移行の際は注意。なるべく<code>#id</code>と<code>.className</code>で走査しろということなんだろうか。</p>
<h2 id=dataメソッドからイベントは発火されない><code>.data()</code>メソッドからイベントは発火されない</h2>
<p>set/getで監視しないようになった。また、<code>.data("abc.def")</code>はabc.defの値のみ取得し、abcからは取得しないとのこと。</p>
<h2 id=jqueryの独立したノードの順序>jQueryの独立したノードの順序</h2>
<p>うーん、これはいいか。</p>
<h2 id=要素中にscriptがある場合実行するようになった>要素中にscriptがある場合実行するようになった</h2>
<p>HTML文字列を扱うメソッド（<code>.append()</code>とか<code>.wrap()</code>とか）にscriptがある場合は <strong>1.9以降はscriptを実行する</strong> ようになり、再実行されるのを防ぐため、そのscriptのノードは除かれるらしい。ほほう。</p>
<p>scriptは同期的に評価されるため実行に時間がかかり、また、scriptの挙動に対してアクセスするインターフェースは用意しませんとのこと。 <strong>「scriptの実行のためにこの挙動を利用するな！」</strong> 、新しいscriptをロードするときには<code>jQuery.getScript()</code>を使ってくれとのこと。</p>
<h2 id=attrとprop><code>.attr()</code>と<code>.prop()</code></h2>
<p><code>.prop()</code>はプロパティの値の取得と設定のために1.6から用意されて、<code>.attr()</code>は値の設定には使わないようにされてきた。1.9においては特別なケースの<code>.attr()</code>の使用をサポートするそう。<a href=http://jquery.com/upgrade-guide/1.9/#attr-versus-prop->例えばチェックボックスの値の設定時の挙動。</a></p>
<h2 id=古代ieにおけるinputattrtype-newvalue>古代IEにおける<code>$("input").attr("type", newValue)</code></h2>
<p>1.9においてもIE6/7/8だと例外が発生するものの、許容するブラウザのために残し、使える場合はどうぞ使ってくださいとのこと。個人的にはこんなイレギュラーなことしないけど。</p>
<h2 id=擬似イベントhover>擬似イベントhover</h2>
<p><code>mouseenter</code> + <code>mouseleave</code>と同義なのでサポートしない。</p>
<h2 id=jqueryオブジェクトのselectorプロパティ>jQueryオブジェクトの<code>.selector</code>プロパティ</h2>
<p>元々非推奨のプロパティだが、v1.9からはメソッドチェーンの場合などにこのプロパティの整合性を保つことをしない。まぁ、これもあまり使わない。</p>
<h2 id=jqueryattr><code>jQuery.attr()</code></h2>
<p>明示されていなかった<code>jQuery.attr(elem, name, value, pass)</code>をサポートしなくなる。よって、今後はpassを引数として使うことが出来ない。</p>
<h2 id=jqueryajaxのjson結果が空文字の場合><code>jQuery.ajax()</code>のJSON結果が空文字の場合</h2>
<p><code>jQuery.ajax</code>が、JSONの結果が空文字の場合を考慮するようになった。v1.9以降、空文字の場合は不正な形式とし、例外をスローする。ただし<code>null</code>の場合を除く。</p>
<h2 id=jqueryproxyのcontext><code>jQuery.proxy()</code>のcontext</h2>
<p>コールバック中のthisがproxy()によって適切に割当たるようになった。コールバックの呼び出し元が<code>null</code>か<code>undefined</code>の場合、<code>this</code>は<code>window</code>になるっぽい。</p>
<h2 id=jquerysubが削除される><code>.jQuery.sub()</code>が削除される</h2>
<p>Coreから外され、プラグインに移動。</p>
<h2 id=dataevents><code>.data("events")</code></h2>
<p>jQueryの明示されていない内部的なイベントデータを取得する。一般的に使わないため公開インターフェースを用意していないため、だそう。たぶん、あまり気にしなくても良い。</p>
<h2 id=明示されていない引数をもつメソッド>明示されていない引数をもつメソッド</h2>
<ul>
<li><code>jQuery.data()</code></li>
<li><code>jQuery.removeData()</code></li>
<li><code>jQuery.attr()</code></li>
</ul>
<p>少し前述したが、予想しない挙動を引き起こす引数の受け方をしなくなるそう。</p>
<h2 id=削除されるプロパティとかメソッド>削除されるプロパティとかメソッド</h2>
<ul>
<li><code>jQuery.deletedIds</code></li>
<li><code>jQuery.uuid</code></li>
<li><code>jQuery.attrFn</code></li>
<li><code>jQuery.offset.bodyOffset()</code></li>
</ul>
<aside class=Share>
<div class=Share__Item>
<button type=button class=Share__Button>🔗 この記事をシェアする</a>
</div>
</aside>
<div popover=auto id=Popover>タイトルと URL をコピーしました</div>
<nav class=Pager>
<div class="Pager__Item Pager__Item--left">
<a href=/posts/2012/backbone-ajax.html>👈 Backbone.jsのAjaxについて</a>
</div>
<div class="Pager__Item Pager__Item--right">
<a href=/posts/2012/enderjs.html>Enderの使い方のまとめ 〜必要なライブラリを必要な分だけ〜 👉</a>
</div>
</nav>
</main>
<aside class=Aside></aside>
<footer class=Footer style=margin-bottom:2%>
<h1>Author</h1>
<div class=Media>
<picture>
<source srcset=/img/1000ch.avif type=image/avif>
<img class=Media__Figure src=/img/1000ch.jpg alt>
</picture>
<div class=Media__Body>
<h3 class=Media__Title>1000ch <a href=https://twitter.com/1000ch class=twitter-follow-button data-show-count=false data-show-screen-name=false>Follow @1000ch</a></h3>
<p>Web アプリケーション開発を専門とするソフトウェアエンジニア。企業で働く傍ら、技術顧問として複数企業のエンジニアリングに関わり、高品質で維持しやすい Web アプリケーションを作るための活動を続けている。</p>
</div>
</div>
</footer>
</div>
<script defer src=https://platform.twitter.com/widgets.js></script>
<script defer src=https://platform.instagram.com/en_US/embeds.js></script>
<script defer src=https://strava-embeds.com/embed.js></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.2/build/highlight.min.js></script>
<script type=module>
import AffiliateLink from '/js/affiliate-link.js';

customElements.define('affiliate-link', AffiliateLink);

const autoPhrase = document.querySelector('#auto-phrase');
const darkMode =  document.querySelector('#dark-mode');
autoPhrase.checked = localStorage.getItem('auto-phrase');
darkMode.checked = localStorage.getItem('dark-mode');

autoPhrase.addEventListener('change', event => {
  if (event.target.checked) {
    localStorage.setItem('auto-phrase', true);
  } else {
    localStorage.removeItem('auto-phrase');
  }
});

darkMode.addEventListener('change', event => {
  if (event.target.checked) {
    localStorage.setItem('dark-mode', true);
  } else {
    localStorage.removeItem('dark-mode');
  }
});

document.querySelectorAll('pre code').forEach(block => {
  hljs.highlightBlock(block);
});

document.querySelector('.Share__Item button').addEventListener('click', async event => {
  event.preventDefault();

  const data = {
    title: document.title,
    text: document.title,
    url: location.href
  };

  if (navigator.canShare?.(data)) {
    await navigator.share(data);
  } else {
    await navigator.clipboard?.writeText(`${data.title} ${data.url}`);
    const popover = document.querySelector('#Popover');
    popover.showPopover();

    setTimeout(() => {
      popover.hidePopover();
    }, 2000);
  }
});
</script>
</body>
</html>