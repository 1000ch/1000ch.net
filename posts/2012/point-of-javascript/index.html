<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>jQueryでコーディングをする際気をつけたいポイント - EagleLand</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel="shortcut icon" href=/favicon.png><link rel="shortcut icon" href=/favicon.svg type=image/svg+xml sizes=any><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=https://unpkg.com/@highlightjs/cdn-assets@11.11.1/styles/a11y-dark.min.css><link rel=stylesheet href=/css/settings.css><link rel=stylesheet href=/css/base.css><link rel=stylesheet href=/css/layout.css><link rel=stylesheet href=/css/components.css><link rel=alternate href=/rss.xml title=1000ch.net type=application/rss+xml><meta name=author content="Shogo Sensui"><meta name=copyright content="Copyright (c) Shogo Sensui; Licensed under Creative Commons Attribution-Noncommercial-Share Japan"><meta property="og:description" content="煩雑なDOMのAPIをラップして扱いやすいインターフェースを提供するjQuery。非常に便利なjQueryだけど、DOM操作のコスト自体が低くなる訳ではないので、実装方法によってはブラウザに大きな負荷をかけてしまう。特に、モバイルデバイスのようなか弱い環境にとってはそれなりにシビアになってくる。端末の性能も飛躍的に向上してきてるとはいえ、最適化された実装を目指さない理由はない。
jQueryでコーディングしていく上で気をつけると良いというポイントを挙げてみる。jQueryと銘打ってるけどそれに限らず、ZeptoでもピュアなJavaScriptでも同じこと。
CSS Selectorのキャッシュ 大半のケースで、要素の再検索は必要ないはず。クエリの実行結果はキャッシュする。
// これはNG $('#hoge').hide(); $('#hoge').css('background', '#ccc'); $('#hoge').show(); jQueryは$()の中にCSSセレクタを渡す事で、指定の要素を探す。つまり、上の例はidがhogeの要素を3回探して、jQueryのインスタンスを3つ生成していることになる。
// これが望ましい var hoge = $('#hoge'); hoge.hide(); hoge.css('background', '#ccc'); hoge.show(); こちらが検索結果を保持し、最適化したコード。要素検索とjQueryオブジェクトの生成が1回のみになっている。変数に格納するしない、あるいはメソッドチェーンするかどうかは、コードの見通しの善し悪しで決めれば良い。
ループ文の書き方 よく書かれがちなループ文。
var array = ['data1', 'data2', 'data3', 'data4', 'data5']; for (var i = 0; i < array.length; i++) { var data = '<div>' + array[i] + '</div>'; // ... } まず、forの継続条件評価式にi < array.lengthとある。継続条件評価はループの度に行われ、配列のlengthプロパティは都度参照されることになる。また、for文の中でvar dataを定義しhtmlを受け取っているが、特殊な理由がない限り、for文の外で定義すべき。これだとループの度にdataが宣言されることなる。
// 上記をふまえたループ文 var array = ['data1', 'data2', 'data3', 'data4', 'data5']; var i, len = array."><meta property="og:image" content="https://1000ch.net//img/apple-touch-icon.png"><meta name=twitter:card content="summary"><meta property="og:type" content="article"><meta property="og:url" content="https://1000ch.net/posts/2012/point-of-javascript/"><meta property="og:site_name" content="EagleLand"><meta property="og:title" content="jQueryでコーディングをする際気をつけたいポイント"><meta name=twitter:site content="@1000ch"><meta name=twitter:url content="https://1000ch.net/posts/2012/point-of-javascript/"><meta name=twitter:title content="jQueryでコーディングをする際気をつけたいポイント"><meta name=google-site-verification content="BWewniqiBzRmrhpj51eLwug-F4hamFfyznl-ARb-Y4Y"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed sizes=114x114 href=/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed sizes=72x72 href=/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed href=/img/apple-touch-icon.png><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-49530352-1","1000ch.net"),ga("send","pageview")</script></head><body><div class=container><header class=header><h1 class=header-title><a href=/><img src=/img/icon.svg>
<span>EagleLand</span></a></h1><nav><a href=/rss.xml>📻 RSS</a>
<a href="https://www.google.co.jp/search?q=site%3A1000ch.net">🔍 検索</a>
<a href=https://shogosensui.com>🌎 Author</a></nav></header><main class=main><h1>jQueryでコーディングをする際気をつけたいポイント</h1><p style=margin:0;text-align:right>Published at 2012-12-02</p><p>煩雑なDOMのAPIをラップして扱いやすいインターフェースを提供するjQuery。非常に便利なjQueryだけど、DOM操作のコスト自体が低くなる訳ではないので、実装方法によってはブラウザに大きな負荷をかけてしまう。特に、モバイルデバイスのようなか弱い環境にとってはそれなりにシビアになってくる。端末の性能も飛躍的に向上してきてるとはいえ、最適化された実装を目指さない理由はない。</p><p>jQueryでコーディングしていく上で気をつけると良いというポイントを挙げてみる。jQueryと銘打ってるけどそれに限らず、ZeptoでもピュアなJavaScriptでも同じこと。</p><h2 id=css-selectorのキャッシュ>CSS Selectorのキャッシュ</h2><p>大半のケースで、要素の再検索は必要ないはず。クエリの実行結果はキャッシュする。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// これはNG
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#hoge&#39;</span>).<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#hoge&#39;</span>).<span style=color:#a6e22e>css</span>(<span style=color:#e6db74>&#39;background&#39;</span>, <span style=color:#e6db74>&#39;#ccc&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#hoge&#39;</span>).<span style=color:#a6e22e>show</span>();
</span></span></code></pre></div><p>jQueryは<code>$()</code>の中にCSSセレクタを渡す事で、指定の要素を探す。つまり、上の例はidがhogeの要素を3回探して、jQueryのインスタンスを3つ生成していることになる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// これが望ましい
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>hoge</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#hoge&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>hoge</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>hoge</span>.<span style=color:#a6e22e>css</span>(<span style=color:#e6db74>&#39;background&#39;</span>, <span style=color:#e6db74>&#39;#ccc&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>hoge</span>.<span style=color:#a6e22e>show</span>();
</span></span></code></pre></div><p>こちらが検索結果を保持し、最適化したコード。要素検索とjQueryオブジェクトの生成が1回のみになっている。変数に格納するしない、あるいはメソッドチェーンするかどうかは、コードの見通しの善し悪しで決めれば良い。</p><h2 id=ループ文の書き方>ループ文の書き方</h2><p>よく書かれがちなループ文。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>array</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;data1&#39;</span>, <span style=color:#e6db74>&#39;data2&#39;</span>, <span style=color:#e6db74>&#39;data3&#39;</span>, <span style=color:#e6db74>&#39;data4&#39;</span>, <span style=color:#e6db74>&#39;data5&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>array</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;div&gt;&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>array</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&lt;/div&gt;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>まず、forの継続条件評価式に<code>i &lt; array.length</code>とある。継続条件評価はループの度に行われ、配列のlengthプロパティは都度参照されることになる。また、for文の中で<code>var data</code>を定義しhtmlを受け取っているが、特殊な理由がない限り、for文の外で定義すべき。これだとループの度にdataが宣言されることなる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 上記をふまえたループ文
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>array</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;data1&#39;</span>, <span style=color:#e6db74>&#39;data2&#39;</span>, <span style=color:#e6db74>&#39;data3&#39;</span>, <span style=color:#e6db74>&#39;data4&#39;</span>, <span style=color:#e6db74>&#39;data5&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>len</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>array</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>len</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>array</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>len</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;div&gt;&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>array</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&lt;/div&gt;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>ちなみに、逆ループにはなるがこれが最速かと思っている。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>array</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;data1&#39;</span>, <span style=color:#e6db74>&#39;data2&#39;</span>, <span style=color:#e6db74>&#39;data3&#39;</span>, <span style=color:#e6db74>&#39;data4&#39;</span>, <span style=color:#e6db74>&#39;data5&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>len</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>array</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>len</span><span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;div&gt;&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>array</span>[<span style=color:#a6e22e>len</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&lt;/div&gt;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h2 id=ループ中のappendはしない>ループ中のappendはしない</h2><p>HTMLの文字列やDOMノード、及びそれらをラップしたjQueryインスタンスを生成し、HTMLドキュメントに追加するケースは多々あるけど、その際の留意点。先程の<code>for</code>ループ処理の最適化と合わせて実施したい。</p><p>まずは、ループ中で都度HTMLドキュメントに対して追加処理をしている例。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 都度appendしてるのはNG
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>container</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;ul&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>array</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;data1&#39;</span>, <span style=color:#e6db74>&#39;data2&#39;</span>, <span style=color:#e6db74>&#39;data3&#39;</span>, <span style=color:#e6db74>&#39;data4&#39;</span>, <span style=color:#e6db74>&#39;data5&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>len</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>array</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;<span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>len</span>;<span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#39;&lt;li&gt;&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>array</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&lt;/li&gt;&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>container</code>に対し、都度HTMLを追加しているが、この記述だとループの度にリフロー+リペイント（HTMLの再レイアウトと再描画）が発生する。この再レイアウトと再描画の発生を少なくすることでちらつきを減らす。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 最後にappendする
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>container</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;ul&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>array</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;data1&#39;</span>, <span style=color:#e6db74>&#39;data2&#39;</span>, <span style=color:#e6db74>&#39;data3&#39;</span>, <span style=color:#e6db74>&#39;data4&#39;</span>, <span style=color:#e6db74>&#39;data5&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>len</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>array</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>html</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;<span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>len</span>;<span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>html</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;&lt;li&gt;&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>array</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&lt;/li&gt;&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>append</span>(<span style=color:#a6e22e>html</span>);
</span></span></code></pre></div><p>このように追加するHTMLを蓄積して、最後にappendすることでHTMLドキュメントに対する変更処理を最小限に留めることができる。</p><h2 id=カスタムデータ属性の参照の仕方>カスタムデータ属性の参照の仕方</h2><blockquote><p>「JavaScriptでhtmlを操作することはもちろん、参照する事すら高価である。」 by <a href=http://twitter.com/cssradar>@cssrasar</a></p></blockquote><p>参照の仕方はいくつかあるけど、jQueryの例も含めて、カスタムデータ属性を参照してみる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;buttonClassName&#34;</span> <span style=color:#a6e22e>data-hoge</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;この値取りたい&#34;</span>&gt;ボタン&lt;/<span style=color:#f92672>button</span>&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;.buttonClassName&#39;</span>).<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;click&#39;</span>, <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// この3つが考えられる
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getAttribute</span>(<span style=color:#e6db74>&#39;data-hoge&#39;</span>));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>$</span>(<span style=color:#66d9ef>this</span>).<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;data-hoge&#39;</span>));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>$</span>(<span style=color:#66d9ef>this</span>).<span style=color:#a6e22e>data</span>(<span style=color:#e6db74>&#39;hoge&#39;</span>));
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>後者2つに関しては、jQueryのインスタンスの生成および内部メソッドを通るため低速になる。このケースに関して言えば、jQueryを通す事はただの遠回りと言える。さらに、<code>.data()</code>の返り値は、暗黙的に型変換されるため注意したい。例えば文字列の"2"であれば<code>Number</code>に型変換される。</p><ul><li><a href=http://havelog.ayumusato.com/develop/javascript/e291-jquery_data_method.html>jQueryの$elm.data()で取得できる値は暗黙でstringから型変換される ::ハブろぐ</a></li><li><a href=http://jsperf.com/html5-data-attribute-dataset-vs-getattribute>HTML5 data attribute - dataset vs getAttribute - jsPerf</a></li><li><a href=http://jsperf.com/dataset-vs-jquery-data/4>dataset vs jquery.data() - jsPerf</a></li></ul><p>jQueryの関数インターフェースの特徴として、参照系は内包する要素の先頭を取得しようとするので、そもそもこれが好きじゃかったりする。コーディングの統一感に反する恐れはあるが、個人的には<code>getAttribute()</code>をオススメしたい。</p><aside class=nav><button type=button id=share-button>🔗 この記事をシェアする</button>
<a href=https://github.com/1000ch/1000ch.net/edit/main/content/posts/2012/point-of-javascript.md>🔗 この記事を GitHub で編集する</a><div><a href=/posts/2012/minify-css-and-js/>👈 CSSファイルとJSファイルを最小化してパフォーマンスを向上させる</a></div><div><a href=/posts/2012/gzip/>👉 Gzipを有効にしてサイト表示速度を向上させる</a></div></aside><div popover=auto id=popover>タイトルと URL をコピーしました</div></main><aside class=aside></aside><footer class=footer><h2>Preference</h2><div class=preference><label><input type=checkbox switch id=auto-phrase> 日本語のフレーズ改行
</label><label><input type=checkbox switch id=dark-mode> ダークモード</label></div><h2>Notice</h2><ul class=notice><li>コンテンツの正確性や信頼性には配慮していますが、必ずしもそれらを保証はしません。意見や見解は、個人の立場において述べたものであり、所属組織等を代表するものではありません。コンテンツの利用およびその結果に対し、一切の責任を負いかねます</li><li>当サイトは amazon.co.jp を宣伝しリンクすることによって、サイトが紹介料を獲得できる手段を提供することを目的に設定されたアフィリエイト宣伝プログラムである、Amazon アソシエイト・プログラムの参加者です</li></ul></footer></div><script defer src=https://platform.twitter.com/widgets.js></script><script defer src=https://platform.instagram.com/en_US/embeds.js></script><script defer src=https://strava-embeds.com/embed.js></script><script defer src=https://embed.bsky.app/static/embed.js></script><script type=module src=https://unpkg.com/baseline-status@1.0.11/baseline-status.min.js></script><script type=module>
import hljs from 'https://unpkg.com/@highlightjs/cdn-assets@11.11.1/es/highlight.min.js';

document.querySelectorAll('pre code').forEach(block => {
  hljs.highlightBlock(block);
});
</script><script type=module>
import AffiliateLink from '/js/affiliate-link.js';

customElements.define('affiliate-link', AffiliateLink);

const autoPhrase = document.querySelector('#auto-phrase');
const darkMode =  document.querySelector('#dark-mode');
autoPhrase.checked = localStorage.getItem('auto-phrase');
darkMode.checked = localStorage.getItem('dark-mode');

autoPhrase?.addEventListener('change', event => {
  if (event.target.checked) {
    localStorage.setItem('auto-phrase', true);
  } else {
    localStorage.removeItem('auto-phrase');
  }
});

darkMode?.addEventListener('change', event => {
  if (event.target.checked) {
    localStorage.setItem('dark-mode', true);
  } else {
    localStorage.removeItem('dark-mode');
  }
});

const shareButton = document.querySelector('.share button');
shareButton?.addEventListener('click', async event => {
  event.preventDefault();

  const data = {
    title: document.title,
    text: document.title,
    url: location.href
  };

  if (navigator.canShare?.(data)) {
    await navigator.share(data);
  } else {
    await navigator.clipboard?.writeText(`${data.title} ${data.url}`);
    const popover = document.querySelector('#Popover');
    popover.showPopover();

    setTimeout(() => {
      popover.hidePopover();
    }, 2000);
  }
});
</script></body></html>